import{r as c,j as i,c as p}from"./client.WVs9LN-p.js";import{e as s,t as u,a as l}from"./extensionStateStorage.vNeqOHuv.js";import{E as a}from"./EmitLog.VaGcFWYO.js";import"./_commonjsHelpers.4gQjN7DL.js";import"./base.zwil0R1V.js";function f(){let e=0;return c.useEffect(()=>{const n=()=>{s.get().then(t=>{t===!0&&window.location.reload()})};s.subscribe(n);const d=()=>{const t=document.createElement("script");t.src=chrome.runtime.getURL("/src/pages/tagLink/index.js"),t.type="module",t.onload=()=>{t.remove()},document.documentElement.appendChild(t)};d();const m=t=>{t.data&&t.data.type==="retry"&&(e++,a({name:"retry",payload:{retries:e}}),d())};window.addEventListener("message",m),window.addEventListener("message",function(t){if(t.source===window&&t.data.action==="backgroundToContent"){const o=t.data.data;a({name:"message",payload:{msg:"Received message from background in content.",data:o}})}}),chrome.runtime.onMessage.addListener((t,o,g)=>{t.action=="getConfig"&&window.postMessage({action:"getConfig"},"*"),t.action=="getEntity"&&window.postMessage({action:"getEntity"},"*"),g()}),document.addEventListener("config",function(t){const o=t.detail.data;u.set(o).then(()=>{a({name:"storage",payload:{msg:"Tag config saved."}})})}),document.addEventListener("entity",function(t){const o=t.detail.data;l.set(o).then(()=>{a({name:"storage",payload:{msg:"Entity saved."}})})})},[]),c.useEffect(()=>{},[]),i.jsx(i.Fragment,{})}const h=()=>{s.subscribe(r);const e=document.createElement("div");e.id="lytics-dev-tools",document.body.append(e);const n=document.createElement("div");n.id="shadow-root",e.attachShadow({mode:"open"}).appendChild(n),p(n).render(i.jsx(f,{}))},r=()=>{s.get().then(e=>{e===!0&&(a({name:"content",payload:{msg:"Extension Activated"}}),h())})};s.subscribe(r);
