import{r as c,j as s,c as m}from"./client.WVs9LN-p.js";import{t as g,a as p,e as d}from"./extensionStateStorage.vNeqOHuv.js";import{E as a}from"./EmitLog.VaGcFWYO.js";import"./_commonjsHelpers.4gQjN7DL.js";import"./base.zwil0R1V.js";function u(){let e=0;return c.useEffect(()=>{const o=()=>{const t=document.createElement("script");t.src=chrome.runtime.getURL("/src/pages/tagLink/index.js"),t.onload=()=>{t.remove()},document.documentElement.appendChild(t)};o();const i=t=>{t.data&&t.data.type==="retry"&&(e++,a({name:"retry",payload:{retries:e}}),o())};window.addEventListener("message",i),window.addEventListener("message",function(t){if(t.source===window&&t.data.action==="backgroundToContent"){const n=t.data.data;a({name:"message",payload:{msg:"Received message from background in content.",data:n}})}}),chrome.runtime.onMessage.addListener(t=>{t.action=="getConfig"&&window.postMessage({action:"getConfig"},"*"),t.action=="getEntity"&&window.postMessage({action:"getEntity"},"*")}),document.addEventListener("config",function(t){const n=t.detail.data;g.set(n).then(()=>{a({name:"storage",payload:{msg:"Tag config saved."}})})}),document.addEventListener("entity",function(t){const n=t.detail.data;p.set(n).then(()=>{a({name:"storage",payload:{msg:"Entity saved."}})})})},[]),c.useEffect(()=>{},[]),s.jsx(s.Fragment,{})}const f=()=>{d.subscribe(r);const e=document.createElement("div");e.id="lytics-dev-tools",document.body.append(e);const o=document.createElement("div");o.id="shadow-root",e.attachShadow({mode:"open"}).appendChild(o),m(o).render(s.jsx(u,{}))},r=()=>{d.get().then(e=>{e===!0&&(a({name:"content",payload:{msg:"Extension Activated"}}),f())})};d.subscribe(r);
